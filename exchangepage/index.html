<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Thammue</title>
    <link rel="stylesheet" href="/css/instyle.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <style>
      /* flash fade in/out */
      #flash{opacity:0;transform:translateY(-4px);transition:opacity .35s ease,transform .35s ease}
      #flash.show{opacity:1;transform:translateY(0)}
      #flash.hide{opacity:0;transform:translateY(-4px)}

      /* ชื่อผู้ใช้ถัดจากไอคอน */
      .icon-buttons .user-area{
        display:flex;align-items:center;gap:8px;color:#fff;text-decoration:none
      }
      .icon-buttons .user-area img{height:26px;width:auto;display:block}
      .icon-buttons .user-chip{
        color:#fff;font-size:14px;opacity:.9;max-width:140px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis
      }
      .icon-buttons .user-area:hover .user-chip{opacity:1}
      @media (max-width:640px){ .icon-buttons .user-chip{display:none} }
      .logout-btn img{height:22px;width:auto;filter:invert(100%)}
    </style>
    
</head>

<body>
    <!-- แถบบนสุด -->
    <ul class="top-nav">
        <!-- ซ้าย -->
        <li><a href="/exchangepage/Uplode.html">อัพโหลดสินค้าแลกเปลี่ยน</a></li>
        <li><span class="top-divider">|</span></li>
        <li><a href="/page/main.html">ซื้อสินค้า</a></li>

        <!-- ขวา -->
        <li class="right"><a href="#notification">แจ้งเตือน</a></li>
        <li><span class="top-divider">|</span></li>
        <li><a href="#help">ช่วยเหลือ</a></li>
        <li><span class="top-divider">|</span></li>
        <li><a href="#lang">ไทย</a></li>
    </ul>

    <!-- Header หลัก -->
    <div class="header-wrapper">
      <div class="logo-container">
        <a href="/page/main.html" class="brand-text">THAMMUE</a>
      </div>

      <div class="search-container">
        <div class="search-group">
          <input type="text" placeholder="ค้นหาสินค้า" />
          <button class="search-button" aria-label="ค้นหา">
            <img src="/img/Icon/search.png" alt="ค้นหา" />
          </button>
        </div>

        <div class="icon-buttons">
          <button class="action-button"><img src="/img/Icon/heart.png"
              alt="รายการโปรด" /></button>
          <button class="action-button"><img
              src="/img/Icon/shopping-cart.png"
              alt="ตะกร้า" /></button>
          <button class="action-button"><img src="/img/Icon/chat.png"
              alt="แชท" /></button>

          <!-- ▼ โปรไฟล์ + ชื่อ + เมนูดรอปดาวน์ -->
          <div class="user-menu" id="userMenu">
            <!---กล่องรวมปุ่มโปรไฟล์ + เมนูดรอปดาวน์ -->

            <button class="user-area" id="userArea" aria-haspopup="true"
              aria-expanded="false"> <!---userArea ที่ไว้ เปิด ปิดเมนู-->

              <img src="/img/Icon/user.png" alt="โปรไฟล์" />
              <span class="user-chip" id="userChip" hidden></span>
              <!---userChip ที่ไว้โชว์ชื่อผู้ใช้-->
              <svg class="chev" viewBox="0 0 20 20" aria-hidden="true">
                <!---ตัวเลขเป็นพิกัดวาดรูปลูกศร ชี้ลง-->
                <path d="M5.5 7.5l4.5 4 4.5-4" fill="none"
                  stroke="currentColor" stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </button>

            <div class="user-dropdown" id="userDropdown"
              role="menu">
              <!-- JS จะเติมรายการให้หลังจาก login/logout -->
            </div>
          </div>
        </div>

      </div>
    </div>


    <nav id="mobileIcons" class="icons-drawer" hidden>
        <button class="icons-drawer__close" aria-label="ปิดเมนู">✕</button>
        <a href="/exchangepage/Request.html"><img src="/img/Icon/exchange.png" alt=""> คำขอแลกเปลี่ยน</a>
        <a href="/exchangepage/fav.html"><img src="/img/Icon/heart.png" alt=""> รายการโปรด</a>
        <a href="/exchangepage/chat.html"><img src="/img/Icon/chat.png" alt=""> แชท</a>
        <a href="/exchangepage/profile.html"><img src="/img/Icon/user.png" alt=""> โปรไฟล์</a>
    </nav>
    <div class="icons-backdrop" hidden></div>

    <div class="category-buttons">
        <a href="/exchangepage/category/Electronics.html" class="category-button">อุปกรณ์อิเล็กทรอนิกส์</a>
        <a href="/exchangepage/category/homeappliances.html" class="category-button">ของใช้ในบ้าน</a>
        <a href="/exchangepage/category/children's.html" class="category-button">อุปกรณ์เด็ก</a>
        <a href="/exchangepage/category/clothing.html" class="category-button">เสื้อผ้า</a>
        <a href="/exchangepage/category/books.html" class="category-button">หนังสือ</a>
        <a href="/exchangepage/category/collectibles.html" class="category-button">ของสะสม</a>
    </div>
    </div>
    <header class="hero">
        <div class="container">
            <h1>เชิญชวนแลกเปลี่ยน</h1>
            <p class="hero-sub">
                เปลี่ยนของที่ไม่ได้ใช้ ให้กลายเป็นคุณค่ากับเพื่อนบ้านและชุมชน — ประหยัดเงิน ลดขยะ ช่วยโลกไปด้วยกัน
            </p>
            <div class="hero-actions">
                <a class="btn btn-primary" href="#exchange-popular">เริ่มต้นแลกเปลี่ยน</a>
                <a class="btn btn-ghost" href="#why-local">ทำไมต้อง THAMMUE?</a>
            </div>
        </div>
    </header>

    <main>
        <!-- สินค้าแลกเปลี่ยนยอดฮิต -->
        <section class="section" id="exchange-popular">
            <div class="container">
                <div class="section-head">
                    <h2>สินค้าแลกเปลี่ยนยอดฮิต</h2>
                    <a class="link" href="#">ดูทั้งหมด</a>
                </div>

                <div class="grid grid-3">
                    <!-- card 1 -->
                    <article class="card">
                        <div class="thumb" role="img" aria-label="หนังสือมือสอง"></div>
                        <div class="card-body">
                            <h3>หนังสือมือสอง</h3>
                            <p class="muted">สภาพดี เหมาะสำหรับนักอ่าน แลกกับกาแฟคูปอง/ต้นไม้กระถาง</p>
                            <div class="meta">
                                <span>หมวด: หนังสือ</span>
                                <span>ระยอง</span>
                            </div>
                            <a class="btn btn-sm" href="#">สนใจแลก</a>
                        </div>
                    </article>

                    <!-- card 2 -->
                    <article class="card">
                        <div class="thumb" role="img" aria-label="เครื่องครัว"></div>
                        <div class="card-body">
                            <h3>เครื่องครัวสแตนเลส</h3>
                            <p class="muted">หม้อ+ตะหลิวใช้น้อยมาก แลกกับวัตถุดิบท้องถิ่น/ผักสวนครัว</p>
                            <div class="meta">
                                <span>หมวด: ของใช้ในบ้าน</span>
                                <span>ชลบุรี</span>
                            </div>
                            <a class="btn btn-sm" href="#">สนใจแลก</a>
                        </div>
                    </article>

                    <!-- card 3 -->
                    <article class="card">
                        <div class="thumb" role="img" aria-label="เสื้อยืด"></div>
                        <div class="card-body">
                            <h3>เสื้อยืดผ้าฝ้ายแท้</h3>
                            <p class="muted">ไซต์ M สภาพใหม่ แลกกับหนังสือ/อุปกรณ์วาดรูป</p>
                            <div class="meta">
                                <span>หมวด: แฟชั่น</span>
                                <span>ฉะเชิงเทรา</span>
                            </div>
                            <a class="btn btn-sm" href="#">สนใจแลก</a>
                        </div>
                    </article>
                </div>
            </div>
        </section>

        <!-- แบนเนอร์ “สินค้าเหลือใช้…” -->
        <section class="section section-band">
            <div class="container band">
                <div class="band-content">
                    <h2>สินค้าเหลือใช้อย่าทิ้ง ลองมาแลกเปลี่ยนกัน</h2>
                    <p class="muted">
                        อัปโหลดรูปและบอกสิ่งที่อยากได้กลับ เราจะช่วยจับคู่ให้เหมาะทั้งราคา คุณค่า และระยะทาง
                    </p>
                    <a class="btn btn-primary" href="#">ดูข้อมูลเพิ่มเติม</a>
                </div>
            </div>
        </section>

        <!-- เพราะคุณชอบหนังสือ -->
        <section class="section">
            <div class="container">
                <h3 class="section-title">เพราะคุณชอบหนังสือ</h3>ๆๆๆๆๆๆๆๆ
                <div class="grid grid-4">
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>นิยายวายป่วน</h4>
                        <p class="muted">แลกกับ: โปสการ์ดทำมือ</p>
                    </article>
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>How to UX เบื้องต้น</h4>
                        <p class="muted">แลกกับ: ปากกา/สมุดโน้ต</p>
                    </article>
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>การเงินแบบมินิมอล</h4>
                        <p class="muted">แลกกับ: ถุงผ้า</p>
                    </article>
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>สรุป JavaScript</h4>
                        <p class="muted">แลกกับ: เมาส์พッド</p>
                    </article>
                </div>
            </div>
        </section>

        <!-- เพราะคุณชอบเสื้อผ้า -->
        <section class="section">
            <div class="container">
                <h3 class="section-title">เพราะคุณชอบเสื้อผ้า</h3>
                <div class="grid grid-4">
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>แจ็กเก็ตยีนส์</h4>
                        <p class="muted">แลกกับ: หมวกแก๊ป</p>
                    </article>
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>กางเกงผ้าลินิน</h4>
                        <p class="muted">แลกกับ: ผ้าพันคอทอมือ</p>
                    </article>
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>กระโปรงพลีท</h4>
                        <p class="muted">แลกกับ: ถุงเท้าใหม่</p>
                    </article>
                    <article class="card mini">
                        <div class="thumb"></div>
                        <h4>รองเท้าผ้าใบ</h4>
                        <p class="muted">แลกกับ: หนังสือการ์ตูน</p>
                    </article>
                </div>
            </div>
        </section>

        <!-- ทำไมเราจึงควรเลือกใช้สินค้าท้องถิ่น -->
        <section class="section section-why" id="why-exchange">
            <div class="container">
                <h2 class="center">การแลกเปลี่ยนสินค้า</h2>
                <h3 class="center muted">ทำไมเราจึงควรแลกเปลี่ยนสินค้า</h3>

                <div class="grid grid-3 mt-24">
                    <div class="reason">
                        <h4>ประหยัดค่าใช้จ่าย</h4>
                        <p class="muted">
                            ลดการซื้อของใหม่ ใช้ของที่มีอยู่ให้คุ้มค่า แลกเปลี่ยนกับสิ่งที่ต้องการได้ทันที
                        </p>
                    </div>
                    <div class="reason">
                        <h4>ลดขยะ สร้างคุณค่าใหม่</h4>
                        <p class="muted">
                            สิ่งของที่ไม่ใช้แล้วไม่ต้องทิ้ง สามารถแลกให้คนอื่นนำไปใช้ต่อ เกิดคุณค่าซ้ำ
                        </p>
                    </div>
                    <div class="reason">
                        <h4>ได้ของที่ตรงใจ</h4>
                        <p class="muted">
                            เลือกสิ่งของที่คุณต้องการจริง ๆ จากการแลก ไม่ต้องลงทุนเพิ่ม และยังสนุกกับการแบ่งปัน
                        </p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container footer-grid">
            <div>
                <h5>เราทำเพื่อ</h5>
                <p class="muted">
                    ที่นี่ช่วยให้แบ่งปัน แลกเปลี่ยน และสร้างคุณค่าใหม่ให้กับสิ่งที่มีอยู่ของทุกคนในชุมชน
                    เพื่อลดขยะ เพิ่มเรื่องราว และวิถีชีวิตที่ยั่งยืน
                </p>
            </div>
            <div>
                <h5>ตรวจสอบสถานะ</h5>
                <ul class="list">
                    <li><a href="#">สถานะการแลกเปลี่ยน</a></li>
                    <li><a href="#">คู่มือสมาชิก</a></li>
                    <li><a href="#">การรับของ</a></li>
                </ul>
            </div>
            <div>
                <h5>SUBSCRIBE</h5>
                <form class="subscribe" action="#" method="post">
                    <input type="email" placeholder="อีเมลของคุณ" required />
                    <button type="submit" class="btn btn-sm">ติดตามข่าว</button>
                </form>
                <div class="social">
                    <a href="#" aria-label="Facebook">🄵</a>
                    <a href="#" aria-label="Instagram">🄸</a>
                    <a href="#" aria-label="YouTube">🅈</a>
                    <a href="#" aria-label="Line">🄻</a>
                </div>
            </div>
        </div>
        <div class="container tiny muted center mt-24">
            copy©ขอบคุณทุกคนในชุมชนที่ร่วมแบ่งปัน
        </div>
    </footer>
    <script>
        const burger = document.querySelector('.hamburger');
        const drawer = document.getElementById('mobileIcons');
        const closeBtn = document.querySelector('.icons-drawer__close');
        const backdrop = document.querySelector('.icons-backdrop');

        function openIcons() {
            drawer.hidden = false; backdrop.hidden = false;
            requestAnimationFrame(() => drawer.classList.add('open'));
            burger.setAttribute('aria-expanded', 'true');
            document.body.style.overflow = 'hidden';
        }
        function closeIcons() {
            drawer.classList.remove('open');
            burger.setAttribute('aria-expanded', 'false');
            document.body.style.overflow = '';
            backdrop.hidden = true;
            setTimeout(() => { if (!drawer.classList.contains('open')) drawer.hidden = true; }, 250);
        }

        burger?.addEventListener('click', openIcons);
        closeBtn?.addEventListener('click', closeIcons);
        backdrop?.addEventListener('click', closeIcons);
        window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeIcons(); });
    </script>


<!-- ดึงชื่อผู้ใช้จาก me.php และจัดการเมนูดรอปดาวน์ -->
    <script>
      //ดึงชื่อผู้ใช้ข้างไอคอนจาก me.php
      (function () {
        const chip = document.getElementById('userChip');
        const userArea = document.getElementById('userArea');
        if (!chip || !userArea) return;

        fetch('/page/backend/me.php', { cache: 'no-store' })
          .then(r => r.ok ? r.json() : { ok:false })
          .then(d => {
            if (!d || !d.ok) { // ไม่ล็อกอิน
              chip.hidden = true; //    ซ่อนชื่อ
              userArea.href = '/page/login.html';  // กดปุ่มโปรไฟล์แล้วพาไปหน้า login
              return;
            }
              //กรณี “ล็อกอินแล้ว”
            const name = (d.user && (d.user.display_name || d.user.name) || '').trim();
            if (name) { 
              chip.textContent = name; // เติมชื่อ
              chip.hidden = false; }  // โชว์ชื่อ
          })
          .catch(() => { chip.hidden = true; }); // มี error ก็ซ่อนชื่อไว้
      })();
    </script>

    <!---เมนูดรอปดาวน์ และควบคุมเปิด/ปิด---!-->
    <script>
(() => {
  const menu = document.getElementById('userMenu');
  const btn  = document.getElementById('userArea');
  const chip = document.getElementById('userChip');
  const dd   = document.getElementById('userDropdown');
  if (!menu || !btn || !chip || !dd) return;

  // ค่าเริ่มต้นสำหรับผู้ที่ยังไม่ล็อกอิน
  dd.innerHTML = `
    <a href="/page/login.html" role="menuitem">เข้าสู่ระบบ</a>
    <a href="/page/add_member.html" role="menuitem">สมัครสมาชิก</a>
  `;

  // ดึงชื่อผู้ใช้จาก PHP
  fetch('/page/backend/me.php', { cache:'no-store' })
    .then(r => r.ok ? r.json() : {ok:false})
    .then(d => {
      if (d && d.ok) {
        const name = (d.user.display_name || d.user.name || '').trim();
        if (name) { chip.textContent = name; chip.hidden = false; }
        dd.innerHTML = `
          <a href="/page/profile.html" role="menuitem">บัญชีของฉัน</a>
          <a href="/page/my_order.html" role="menuitem">การซื้อของฉัน</a>
          <hr>
          <a href="/page/backend/logout.php" role="menuitem" class="logout">ออกจากระบบ</a>
        `;
      } else {
        chip.hidden = true; // guest
      }
    })
    .catch(() => { chip.hidden = true; });

  // เปิด/ปิดด้วยคลิก (สำหรับมือถือ)
  btn.addEventListener('click', e => {
    e.preventDefault();
    const open = menu.classList.toggle('open');
    btn.setAttribute('aria-expanded', open);
  });

  // ปิดเมื่อคลิกข้างนอกหรือกด Esc
  document.addEventListener('click', e => {
    if (!menu.contains(e.target)) { menu.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }
  });
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') { menu.classList.remove('open'); btn.setAttribute('aria-expanded','false'); btn.blur(); }
  });
})();
</script>

    

</body>

</html>