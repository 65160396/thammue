<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Thammue - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/open-shop.css" />
  </head>
  <body class="open-shop">
    <!-- ‡πÅ‡∏ñ‡∏ö‡∏ö‡∏ô‡∏™‡∏∏‡∏î -->
    <ul class="top-nav">
      <!-- ‡∏ã‡πâ‡∏≤‡∏¢ -->
      <li><a
          href="/exchangepage/public/index.html">‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
      <li><span class="top-divider">|</span></li>
      <li><a id="openOrMyShop"
          href="/page/open_a_shop.html">‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>

      <!-- ‡∏Ç‡∏ß‡∏≤ -->
      <li class="right"><a
          href="/page/notifications.html">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</a></li>
      <li><span class="top-divider">|</span></li>
      <li><a href="#help">‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</a></li>
      <li><span class="top-divider">|</span></li>
      <li><a href="#lang">‡πÑ‡∏ó‡∏¢</a></li>
    </ul>

    <!-- Header -->
    <div class="header-wrapper">
      <div class="logo-container">
        <a href="/page/main.html" class="brand-text">THAMMUE</a>
      </div>
      <div class="search-container">
        <div class="icon-buttons">

          <a class="action-button" href="/page/storepage/chat.html"
            aria-label="‡πÅ‡∏ä‡∏ó" style="position:relative">
            <img src="/img/Icon/chat.png" alt="‡πÅ‡∏ä‡∏ó">
            <span id="chatBadge" class="icon-badge" hidden>0</span>
          </a>

          <div class="user-menu" id="userMenu">
            <button class="user-area" id="userArea"
              aria-haspopup="true" aria-expanded="false">
              <img src="/img/Icon/user.png" alt="‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå" />
              <span class="user-chip" id="userChip" hidden></span>
              <svg class="chev" viewBox="0 0 20 20"
                aria-hidden="true">
                <path d="M5.5 7.5l4.5 4 4.5-4" fill="none"
                  stroke="currentColor" stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </button>
            <div class="user-dropdown" id="userDropdown"
              role="menu"></div>
          </div>
        </div>
      </div>
    </div>

    <section class="open-shop">
      <div class="wizard-page">
        <div class="wizard-card">
          <h2 class="form-section">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

          <div class="field"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô</label> <div
              id="shopName">‚Äî</div></div>
          <div class="field"><label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label> <div
              id="shopEmail">‚Äî</div></div>
          <div class="field"><label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label> <div
              id="shopPhone">‚Äî</div></div>
          <div class="field"><label>‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á</label> <div
              id="shopAddr">‚Äî</div></div>
          <div class="field"><label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label> <div
              id="shopStatus">‚Äî</div></div>

          <div style="margin-top:16px; display:flex; gap:12px;">
            <!-- ‡πÉ‡∏ô store-info.html -->
            <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏° -->
            <a id="btnEdit" class="btn" href="#">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</a>

            <script>
  // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ d ‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡πâ‡∏ß (‡∏à‡∏≤‡∏Å API ‡πÄ‡∏î‡∏¥‡∏°)
  // d = { id, shop_name, email, phone, pickup_addr, province, status }

  const btn = document.getElementById('btnEdit');
  btn.addEventListener('click', (e) => {
    e.preventDefault();
    const payload = {
      shop_id: d.id,
      shop_name: d.shop_name,
      email: d.email,
      phone: d.phone,
      pickup_addr: d.pickup_addr,
      province: d.province,
      status: d.status,
      ts: Date.now()
    };
    sessionStorage.setItem('store_edit_prefill', JSON.stringify(payload));
    location.href = `/page/storepage/store-edit-info.html?shop_id=${encodeURIComponent(d.id)}`;
  });
</script>

          </div>
        </div>
      </div>
    </section>

    <!-- ‡∏ñ‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏ô‡∏π‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡πÑ‡∏ü‡∏•‡πå 2 ‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ -->
    <script src="/js/me.js"></script>
    <script src="/js/user-menu.js"></script>
    <script src="/js/header-noti.js"></script>
    <script src="/js/notify-poll.js"></script>

    <!---‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á -->
    <script src="/js/store/shop-toggle.js"></script>
    <script>
  document.addEventListener('DOMContentLoaded', () => {
    toggleOpenOrMyShop();
  });
</script>
    <script>
  (async () => {
    const res  = await fetch('/page/backend/productsforsale/get_shop.php', { credentials: 'include' });
    const data = await res.json();
    const s    = data.shop || {};

    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    document.getElementById('shopName').textContent   = s.shop_name   || '(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô)';
    document.getElementById('shopEmail').textContent  = s.email       || '-';
    document.getElementById('shopPhone').textContent  = s.phone       || '-';
    document.getElementById('shopAddr').textContent   = s.pickup_addr || '-';
    document.getElementById('shopStatus').textContent = s.status      || '-';

    const id = s.id; // id ‡∏£‡πâ‡∏≤‡∏ô‡∏à‡∏≤‡∏Å API

    const btnEdit = document.getElementById('btnEdit');
    if (btnEdit) {
      btnEdit.addEventListener('click', (e) => {
        e.preventDefault();
        if (!id) return alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏£‡πâ‡∏≤‡∏ô');

        // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç prefill ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        sessionStorage.setItem('store_edit_prefill', JSON.stringify({
          shop_id: id,
          shop_name: s.shop_name || '',
          email: s.email || '',
          phone: s.phone || '',
          pickup_addr: s.pickup_addr || '',
          province: s.province || '',
          status: s.status || '',
          ts: Date.now()
        }));

        // üëâ ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤" (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)
        location.href = `/page/storepage/store-edit-info.html?shop_id=${encodeURIComponent(id)}`;
      });
    }

    const btnView = document.getElementById('btnView');
    if (btnView) {
      btnView.addEventListener('click', () => {
        if (!id) return alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏£‡πâ‡∏≤‡∏ô');
        location.href = `/page/storepage/store_public.php?id=${encodeURIComponent(id)}`;
      });
    }
  })();
</script>

  </body>
</html>
