<!DOCTYPE html>
<html lang="th">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Thammue – หมวดหมู่</title>
        <link rel="stylesheet" href="/css/style.css" />
        <link rel="stylesheet" href="/css/instyle.css" />
        <link rel="stylesheet" href="/css/products.css" />
        <link rel="stylesheet" href="/css/search.css">
    </head>
    <body data-slug="second_hand">
        <!-- reuse top bar -->
        <ul class="top-nav">
            <!-- ซ้าย -->
            <li><a
                    href="/exchangepage/public/index.html">แลกเปลี่ยนสินค้า</a></li>
            <li><span class="top-divider">|</span></li>
            <li><a id="openOrMyShop"
                    href="/page/open_a_shop.html">เปิดร้านค้า</a></li>

            <!-- ขวา -->
            <li class="right">
                <a id="notiBtn" href="/page/notifications.html">แจ้งเตือน
                    <span id="notiBadge" class="badge" hidden></span>
                </a>
            </li>
            <li><span class="top-divider">|</span></li>
            <li><a href="#help">ช่วยเหลือ</a></li>
            <li><span class="top-divider">|</span></li>
            <li><a href="#lang">ไทย</a></li>
        </ul>

        <!-- Header หลัก -->
        <div class="header-wrapper">
            <div class="logo-container">
                <a href="/page/main.html" class="brand-text">THAMMUE</a>
            </div>

            <!-- ▼ ปุ่มแฮมเบอร์เกอร์ (มือถือ) -->
            <button
                class="hamburger"
                id="hamburgerBtn"
                type="button"
                aria-label="เมนู"
                aria-controls="iconsDrawer"
                aria-expanded="false">
                <img src="/img/Icon/menu.png" alt="เมนู" />
            </button>

            <div class="search-container">
                <!-- ค้นหา-->
                <div class="search-group">
                    <input id="q" type="text" placeholder="ค้นหาสินค้า"
                        autocomplete="off" autocapitalize="off"
                        spellcheck="false"
                        role="combobox" aria-autocomplete="list"
                        aria-expanded="false"
                        aria-controls="qSuggest" aria-haspopup="listbox" />
                    <button id="btnSearch" class="search-button" type="button"
                        aria-label="ค้นหา">
                        <img src="/img/Icon/search.png" alt="ค้นหา" />
                    </button>
                    <!-- ซ่อน suggest ตั้งต้น -->
                    <div id="qSuggest" class="search-suggest" hidden></div>
                </div>

                <div class="icon-buttons desktop-icons">
                    <a class="action-button" href="/page/favorites/index.php"
                        aria-label="รายการโปรด">
                        <img src="/img/Icon/heart.png" alt="รายการโปรด">
                        <span id="favBadge" class="icon-badge" hidden>0</span>
                    </a>

                    <a class="action-button" href="/page/cart/index.php"
                        aria-label="ตะกร้า" style="position:relative">
                        <img src="/img/Icon/shopping-cart.png" alt="ตะกร้า">
                        <span id="cartBadge" class="icon-badge" hidden>0</span>
                    </a>

                    <a class="action-button" href="/page/storepage/chat.html"
                        aria-label="แชท" style="position:relative">
                        <img src="/img/Icon/chat.png" alt="แชท">
                        <span id="chatBadge" class="icon-badge" hidden>0</span>
                    </a>

                    <!-- โปรไฟล์ + ชื่อ + เมนู -->
                    <div class="user-menu" id="userMenu">
                        <button class="user-area" id="userArea"
                            aria-haspopup="true" aria-expanded="false">
                            <img src="/img/Icon/user.png" alt="โปรไฟล์" />
                            <span class="user-chip" id="userChip" hidden></span>
                            <svg class="chev" viewBox="0 0 20 20"
                                aria-hidden="true">
                                <path d="M5.5 7.5l4.5 4 4.5-4" fill="none"
                                    stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                        </button>
                        <div class="user-dropdown" id="userDropdown"
                            role="menu"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ปุ่มหมวด -->
        <div class="category-buttons">
            <a href="/page/category/handmade.html" data-slug="handmade"
                class="category-button">สินค้าแฮนเมด</a>
            <a href="/page/category/craft.html" data-slug="craft"
                class="category-button">งานประดิษฐ์</a>
            <a href="/page/category/local_products.html"
                data-slug="local_products"
                class="category-button">สินค้าท้องถิ่น</a>
            <a href="/page/category/second_hand.html" data-slug="second_hand"
                class="category-button">สินค้ามือสอง</a>
        </div>

        <!-- ส่วนผลลัพธ์ที่ค้นหา -->
        <section id="searchSection" class="search-results" hidden>
            <div class="search-results__head">
                <h2>ผลการค้นหา <span id="searchCount"></span></h2>
                <a href="#" id="clearSearch"
                    class="btn btn-primary">ล้างการค้นหา</a>
            </div>
            <div id="results" class="product-grid"></div>
        </section>

        <section class="recommended-products">
            <h2 id="catTitle">กำลังโหลด...</h2>
            <div id="catGrid" class="product-grid"></div>
        </section>

        <!-- ===== Drawer มือถือ ===== -->
        <div class="icons-drawer" id="iconsDrawer" hidden>
            <button class="icons-drawer__close" id="iconsClose"
                type="button">ปิด</button>

            <a href="/page/favorites/index.php">
                <img src="/img/Icon/heart.png" alt /> รายการโปรด
                <span class="badge" id="favBadgeMobile" hidden>0</span>
            </a>

            <a href="/page/cart/index.php">
                <img src="/img/Icon/shopping-cart.png" alt /> ตะกร้า
                <span class="badge" id="cartBadgeMobile" hidden>0</span>
            </a>

            <a href="/page/storepage/chat.html">
                <img src="/img/Icon/chat.png" alt /> แชท
                <span class="badge" id="chatBadgeMobile" hidden>0</span>
            </a>

            <!-- โปรไฟล์ใน drawer -->
            <button id="mobileProfileToggle" class="drawer-acc"
                aria-expanded="false" type="button">
                <img src="/img/Icon/user.png" alt> โปรไฟล์
                <svg class="chev" viewBox="0 0 20 20" aria-hidden="true">
                    <path d="M5.5 7.5l4.5 4 4.5-4" fill="none"
                        stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </button>
            <div id="mobileAccountMenu" class="drawer-acc-menu" hidden></div>
        </div>
        <div class="icons-backdrop" id="iconsBackdrop" hidden></div>

        <!-- สคริปต์ระบบแกนกลางของ header -->
        <script src="/js/nav-active.js"></script>
        <script src="/js/flashmessage.js"></script>
        <script src="/js/me.js"></script>
        <script src="/js/user-menu.js"></script>
        <script src="/js/store/shop-toggle.js"></script>
        <script src="/js/fav-badge.js" defer></script>
        <script src="/js/header-noti.js"></script>
        <script src="/js/notify-poll.js"></script>
        <script>
      document.addEventListener('DOMContentLoaded', () => {
        toggleOpenOrMyShop();
      });
    </script>

        <!-- โหลดสินค้าของหมวด (ต้องมี) -->
        <script src="/js/productsforsale/products.js"></script>
        <script src="/js/category/category-feed.js" defer></script>
        <script src="/js/cart-badge.js" defer></script>

        <!-- ค้นหา -->
        <script src="/js/search/search.js"></script>
        <script src="/js/search/category-search.js"></script>

        <!-- โหลดหลังจากมี DOM ของ drawer/backdrop แล้ว -->
        <script src="/js/nav/hamburger.js"></script>
        <script src="/js/nav/drawer-sync.js"></script>

    </body>
</html>
